<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<style type="text/css">
</style>
<script type="text/javascript">
	$(function() {

	});
</script>
</head>
<body>
<th:block th:fragment="chatContentsForm">
<div id="chat-root" class="h-full overflow-auto">
	<div class="flex flex-col justify-between w-full h-full bg-[#e9edef]">
		<div class="relative" th:if="${product != null}" th:object="${product}">
			<div class="flex items-center w-full gap-2 px-3 py-4 bg-white">
				<a class="flex flex-grow h-10 gap-4 flex-1" th:href="@{/product/{pnum}(pnum=${pnum})}">
					<div class="relative w-10 h-10 aspect-square">
						<img alt="상품 썸네일" loading="lazy" decoding="async"
							data-nimg="fill" class="rounded-md"
							th:src="@{/images/thumbnail/{thumbnail}(thumbnail=*{thumbnail})}"
							style="position: absolute; height: 100%; width: 100%; inset: 0px; color: transparent;">
					</div>
					<div>
						<div class="flex items-center">
							<span th:text="|*{#numbers.formatInteger(price,3,'COMMA')}원|" class="font-semibold text-[15px] text-jnGray-900">30,000원</span>
						</div>
						<span th:text="*{title}" class="block text-[12px] break-all line-clamp-1">산리오 러브 말차 풀셋 미개봉</span>
					</div></a>
			</div>
		</div>
		<div class="overflow-auto p-5 h-full" id="chat-scroll">
			<div class="flex flex-col gap-2 w-inherit" id="chat-messages">
			<input type="hidden" id="user-id" th:value="${session.uid}">
			<input type="hidden" id="room-num" th:value="${roomNum}">
			<input type="hidden" id="other-id" th:value="${otherId}">
				<th:block th:if="${roomNum != null}">
					<div type="textMessage" th:each="chatLog:${chatList}" th:object="${chatLog}">
						<div th:if="*{writerId} == ${session.uid}" class="flex items-end w-auto mb-2 flex-start space-x-1 flex-row-reverse space-x-reverse">
							<div class="p-3 rounded-xl h-auto overflow-hidden rounded-tr bg-[#363C45] text-white w-auto">
								<p th:text="*{content}" class="msg-text break-all whitespace-pre-wrap [&amp;&gt;a]:text-jngreen [&amp;&gt;a]:underline"></p>
							</div>
							<div class="flex flex-col">
								<p th:text="*{readDate != null?'읽음':''}" class="msg-read mb-0 text-right text-[13px]"></p>
								<span th:text="*{#dates.format(chatDate, 'a h:mm')}" class="msg-time block text-[13px] uppercase text-end"></span>
							</div>
						</div>
						<div th:unless="*{writerId} == ${session.uid}" class="flex items-end w-auto mb-2 flex-start space-x-1">
							<div class="p-3 rounded-xl h-auto overflow-hidden rounded-tl bg-white w-auto">
								<p th:text="*{content}" class="msg-text break-all whitespace-pre-wrap [&amp;&gt;a]:text-jngreen [&amp;&gt;a]:underline"></p>
							</div>
							<div class="flex">
								<span th:text="*{#dates.format(chatDate, 'a h:mm')}" class="msg-time block text-[13px] uppercase text-start"></span>
							</div>
						</div>
					</div>
				</th:block>
			</div>
		</div>
	</div>
</div>
<form id="chat-form" class="bg-[#F7F9FA] py-3 px-3 flex flex-col rounded-xl focus-within:shadow-banner h-auto">
	<textarea id="chat-input" title="채팅" autocomplete="off" maxlength="1000"
		class="shrink-0 bg-transparent placeholder:text-[#9CA3AF] outline-none resize-none text-md h-16 w-full pre-wrap"
		placeholder="메시지를 입력해주세요" name="chat"></textarea>
	<div class="flex justify-between">
		<div class="flex gap-2" id="chat-input-action-button-container">
			<div>
				<div class="block">
					<label for="chat-image-upload" class="text-sm font-semibold leading-none text-gray-600 cursor-pointer block border-[#e1e1e1] text-center border-0 m-0 p-0 w-6 h-6">
						<input id="chat-image-upload" name="chat-image-upload" type="file" class="peer px-4 md:px-5 appearance-none border text-input text-xs lg:text-sm font-body placeholder-body min-h-12 transition duration-200 ease-in-out bg-gray-100 border-gray-300 focus:shadow focus:bg-white focus:border-primary hidden w-auto py-0 rounded"
						autocomplete="off" spellcheck="false" aria-invalid="false" accept="image/png, image/jpeg, image/jpg" multiple="">
						<svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="w-full h-full" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
							<path fill-rule="evenodd" d="M.002 3a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2h-12a2 2 0 01-2-2V3zm1 9l2.646-2.354a.5.5 0 01.63-.062l2.66 1.773 3.71-3.71a.5.5 0 01.577-.094L15.002 9.5V13a1 1 0 01-1 1h-12a1 1 0 01-1-1v-1zm5-6.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z"
								clip-rule="evenodd">
							</path></svg>
					</label>
				</div>
			</div>
		</div>
		<div class="flex items-end space-x-2">
			<span class="text-sm leading-5 text-gray-400"><span id="chat-count">0</span> / 1000</span>
			<button id="send-chat" type="button" disabled="" class="w-6 h-6">
				<svg stroke="currentColor" fill="currentColor" stroke-width="0"
					viewBox="0 0 512 512" class="w-full h-full fill-[#9CA3AF]"
					height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">
					<path
						d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm143.6 28.9l72.4-75.5V392c0 13.3 10.7 24 24 24h16c13.3 0 24-10.7 24-24V209.4l72.4 75.5c9.3 9.7 24.8 9.9 34.3.4l10.9-11c9.4-9.4 9.4-24.6 0-33.9L273 107.7c-9.4-9.4-24.6-9.4-33.9 0L106.3 240.4c-9.4 9.4-9.4 24.6 0 33.9l10.9 11c9.6 9.5 25.1 9.3 34.4-.4z"></path></svg>
			</button>
		</div>
	</div>
</form>
<template id="my-message">
<div type="textMessage" class="my-msg">
	<div class="flex items-end w-auto mb-2 flex-start space-x-1 flex-row-reverse space-x-reverse">
		<div class="p-3 rounded-xl h-auto overflow-hidden rounded-tr bg-[#363C45] text-white w-auto">
			<p class="msg-text break-all whitespace-pre-wrap [&amp;&gt;a]:text-jngreen [&amp;&gt;a]:underline"></p>
		</div>
		<div class="flex flex-col">
			<p class="msg-read mb-0 text-right text-[13px]"></p>
			<span class="msg-time block text-[13px] uppercase text-end"></span>
		</div>
	</div>
</div>
</template>
<template id="other-message">
<div type="textMessage">
	<div class="flex items-end w-auto mb-2 flex-start space-x-1">
		<div class="p-3 rounded-xl h-auto overflow-hidden rounded-tl bg-white w-auto">
			<p class="msg-text break-all whitespace-pre-wrap [&amp;&gt;a]:text-jngreen [&amp;&gt;a]:underline"></p>
		</div>
		<div class="flex">
			<span class="msg-time block text-[13px] uppercase text-start"></span>
		</div>
	</div>
</div>
</template>
</th:block>
</body>
</html>