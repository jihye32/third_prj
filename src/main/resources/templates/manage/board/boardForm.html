<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title th:text="${dto.type == 'FAQ' ? (mode=='edit'?'FAQ 수정':'FAQ 작성') : (mode=='edit'?'공지 수정':'공지 작성')}">
    글 작성/수정
  </title>
   <link rel="stylesheet" th:href="@{/css/style.css}">
  <!-- jQuery -->
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>

  <!-- Summernote -->
  <link href="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/summernote@0.8.20/dist/summernote-lite.min.js"></script>

  <style>
    body{margin:0;background:#f5f6f8;font-family: Arial, Helvetica, sans-serif;}
    .topbar{height:52px;background:#0b1d3a;color:#fff;display:flex;align-items:center;justify-content:space-between;padding:0 18px;}
    .wrap{padding:18px;}
    .card{background:#fff;border-radius:6px;padding:18px;box-shadow:0 1px 2px rgba(0,0,0,.06);}
    .row{display:flex;gap:12px;align-items:center;margin-bottom:12px;}
    .row .left{width:120px;color:#333;font-weight:750;}
    input[type="text"]{width:100%;height:38px;border:1px solid #d7dbe2;border-radius:4px;padding:0 10px;font-size:14px;}
    .actions{display:flex;justify-content:flex-end;margin-top:14px;gap:8px;}
    .btn{min-width:92px;height:34px;border:none;border-radius:4px;background:#111827;color:#fff;cursor:pointer;font-size:13px;}
    .btn2{min-width:92px;height:34px;border:1px solid #cfd6e3;border-radius:4px;background:#fff;color:#111827;cursor:pointer;font-size:13px;}
  </style>
</head>
<body>

<header th:replace="manage/common_layout :: header"></header>
<div class="wrap" style="padding-top:85px;">
  <div class="card">

    <form method="post"
          th:action="${dto.type=='FAQ'}
                      ? (${mode=='edit'} ? @{/manage/faq/modifyProcess} : @{/manage/faq/writeProcess})
                      : (${mode=='edit'} ? @{/manage/notice/modifyProcess} : @{/manage/notice/writeProcess})"
          onsubmit="return validateForm();">

      <input type="hidden" name="boardNum" th:if="${mode=='edit'}" th:value="${dto.boardNum}"/>

      <input type="hidden" name="boardType" th:value="${dto.boardType}"/>
      <input type="hidden" name="type" th:value="${dto.type}"/>

      <div class="row" style="max-width:260px;">
        <input type="text" th:value="${dto.type=='FAQ'?'Faq':'Notice'}" readonly>
      </div>

      <div class="row">
        <div class="left">제목</div>
        <div style="flex:1;">
          <input type="text" name="title" placeholder="제목을 입력하세요"
                 th:value="${dto.title}" maxlength="100" required/>
        </div>
      </div>

      <div class="row" style="align-items:flex-start;">
        <div class="left" style="padding-top:8px;">내용</div>
        <div style="flex:1;">

          <textarea id="content" name="content" th:text="${dto.content}"></textarea>
        </div>
      </div>

      <div class="actions">
        <button type="button" class="btn2"
                th:onclick="${dto.type=='FAQ'} ? 'location.href=\'/manage/faq/faq\'' : 'location.href=\'/manage/notice/notice\''">
          취소
        </button>
        <button type="submit" class="btn" th:text="${mode=='edit'} ? '수정' : '작성'">작성</button>
      </div>
    </form>

  </div>
</div>

<script>
  $(function () {
    $('#content').summernote({
      height: 590
    });
  });

  function validateForm(){
    const title = $('input[name="title"]').val().trim();
    const html = $('#content').summernote('code');
    const text = $('<div>').html(html).text().trim();

    if(!title){
      alert("제목을 입력하세요.");
      return false;
    }
    if(!text){
      alert("내용을 입력하세요.");
      return false;
    }
    return true;
  }
</script>
</body>
</html>